# Identifying Salmonella colonisation determinants in mice

This analysis is based on the BarSeq screen described in [Import of aspartate and malate by DcuABC drives H2/fumarate respiration to promote initial Salmonella gut-lumen colonization in mice](https://doi.org/10.1016%2Fj.chom.2020.04.013).
In this paper, the authors generated a barcoded library of Salmonella mutants. This library was then used to infect LCM mice, and the fecal pellets from the infected mice were collected on days 1, 2,3, and 4 post infection. Each of the 


```{warning}

This walkthrough is currently under construction

```

## Setup

1. Download and unpack [the test data](walkthrough_downloads/nguyenb.tar.gz). After running the command below, you should see a directory named `nguyenb_walkthrough`, which should contain all the data you need for this walkthrough. 

```shell
tar -xvzf nguyenb.tar.gz
cd nguyenb_walkthrough
ls 
```

You should see the following files:

```shell
control_strains.csv
dnaid1315_124_subsample.fasta.gz
dnaid1315_17_mbarq_counts.csv
dnaid1315_18_mbarq_counts.csv
library_11_1_mbarq_merged_counts.csv
library_11_1_sub_1.fq.gz
sample_data.csv
SL1344.gff
SL1344.fna

```

2. Make sure `mbarq` is installed and you have created and activated the `mbarq` environment

```shell

conda activate mbarq

```


## Mapping 

First thing in the analysis of random barcode mutagenesis experiment is figuring out the position of each barcode in the host genome. This can be accomplished with `mbarq map`.
`library_11_1_sub_1.fq.gz` is a subsample of the mutant library sequencing file. This was generated by running a PCR with one primer against the transposon construct containing the barcode, and a random primers that should bind the host DNA. Thus each read in this file should have the barcode, part of the transposon construct, and some host DNA sequence.

```{note}

Here's an example of a read from the `library_11_1_sub_1.fq.gz` file. The transposon conserved sequence (IR) is shown in **bold** and the barcode is shown in `color`. The spacer sequence between the barcode and the IR is shown in lower case, and the host sequence in upper case. For `mbarq`, this will translate into B17N13GTGTATAAGAGACAG

``GGGACCAAAGTACTAGA``tcagggttgagat**GTGTATAAGAGACAG**ATTGTATTCGCC[...]

```

To map barcodes to insertions run:

```shell

mbarq map -f library_11_1_sub_1.fq.gz -g SL1344.fna -a SL1344.gff \
          -tn B17N13GTGTATAAGAGACAG -n nguyenb_library_map
 
```

The final results will be saved in nguyenb_library_map.annotated.csv


## Counting




## Merging count files

## Analysis

